const API_ORIGIN =
  (import.meta as any).env?.VITE_API_ORIGIN ||
  (import.meta as any).env?.VITE_API_URL ||
  "http://127.0.0.1:3000";

export function resolveMediaUrl(u?: string | null): string | null {
  const s = (u ?? "").trim();
  if (!s) { console.warn("EMPTY_MEDIA_URL", u, "\nSTACK:\n", new Error().stack); return null; }

  if (s.startsWith("http://") || s.startsWith("https://")) return s;
  if (s.startsWith("/")) return `${API_ORIGIN}${s}`;
  return `${API_ORIGIN}/${s}`;
}
